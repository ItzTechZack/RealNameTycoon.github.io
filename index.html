<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://code.jquery.com/ui/jquery-ui-git.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://code.jquery.com/ui/jquery-ui-git.js"></script>
</head>
<body>


<fieldset>

<legend>Tycoon Calculator</legend>
<p></p>

<div class="singleField">
    <label for="currentLvl">Current Level</label>
    <input tabindex="0" type="number" id="currentLvl" step="1" placeholder="Required" class="text ui-widget-content ui-corner-all">
</div>
<div class="singleField"><div class="singleField">
    <label for="currentLvlExp">Current Lvl exp (total exp)<br>Not required but more accurate</label>
    <input tabindex="1"  type="number" id="currentLvlExp" step="1" class="text ui-widget-content ui-corner-all">
</div>

<div class="singleField">
    <label for="targetLvl">Target Level</label>
    <input type="number" id="targetLvl" step="1" placeholder="Required" class="text ui-widget-content ui-corner-all">
</div>

<div class="singleField">
    <label for="voucherPerRun">Vouchers per run</label>
    <input type="number" id="voucherPerRun" step="1" class="text ui-widget-content ui-corner-all">
</div>

<div class="singleField">
    <label for="isPremium">Premium</label>
    <input type="checkbox" id="isPremium">
</div>

<div class="singleField">

  <div id="noPremiumSelect">
    <label for="voucherTypeNoPremium">Select the voucher type</label>
        <select name="speed" id="voucherTypeNoPremium">
          <option value="0.2" selected>Airline (Piloting: 0.2 exp)</option>
          <option value="0.3">Casino (Casino: 0.3 exp)</option>
          <option value="0.15">Garbage (Garbage: 0.15 exp)</option>
          <option value="0.8">Gym (Strength: 0.8)</option>
          <option value="0.1">Heli Pilot (Helicopter Pilot: 0.1)</option>
          <option value="0.6">Mail (Player: 0.6)</option>
          <option value="2.5">Medic (EMS: 2.5)</option>
          <option value="0.2">Police (Police: 0.2)</option>
          <option value="1.2">Train (Train Conductor: 1.2)</option>
        </select>
    </div>

<div id="yesPremiumSelect" class="hiddenS">
        <label for="voucherTypeYesPremium">Select the <b>PREMIUM</b> voucher type</label>
            <select name="speed" id="voucherTypeYesPremium">
              <option value="0.3" selected>Airline (Piloting: 0.3 exp)</option>
              <option value="0.45" >Casino (Casino: 0.45 exp)</option>
              <option value="0.23" >Garbage (Garbage: 0.23 exp)</option>
              <option value="1.2" >Gym (Strength: 1.2)</option>
              <option value="0.15" >Heli Pilot (Helicopter Pilot: 0.15)</option>
              <option value="0.9" >Mail (Player: 0.9)</option>
              <option value="3.75" >Medic (EMS: 3.75)</option>
              <option value="0.3" >Police (Police: 0.3)</option>
              <option value="1.2" >Train (Train Conductor: 1.8)</option>
            </select>

  </div>


</div>




<div class="singleField">
  <button class="ui-button ui-widget ui-corner-all" id="submitVoucher">Calculate</button>
</div>

</fieldset>

<fieldset>
    <legend>Result</legend>
	<p></p>
    <label for="voucherAmmount">Vouchers needed</label>
    <input type="text" id="voucherAmmount" class="text ui-widget-content ui-corner-all" disabled>
    <label for="expAmmount">Exp needed</label>
    <input type="text" id="expAmmount" class="text ui-widget-content ui-corner-all" disabled>
    <label for="runsAmmount">Number of runs</label>
    <input type="text" id="runsAmmount" class="text ui-widget-content ui-corner-all" disabled>


</fieldset>

<h6 id="lastUpdated">Last updated - 08/21/2018</h6>


<script>
    $( document ).ready(function() {


      $(document).keypress(function(e) {
        if(e.which == 13) {
          $("#submitVoucher").trigger("click");
        }
      });

      $( "#submitVoucher" ).button();
      $( "#voucherTypeNoPremium" ).selectmenu();
      $( "#voucherTypeYesPremium" ).selectmenu();

      $("#isPremium").checkboxradio();

      $("#isPremium").change(function() {
          $("#noPremiumSelect").toggleClass("hiddenS");
          $("#yesPremiumSelect").toggleClass("hiddenS");
       });

        $("#targetLvl").on("input", a =>{

            if(parseInt($("#currentLvl").val()) >= parseInt($("#targetLvl").val())){
                $("#targetLvl").css("border-color","red");
            }else{
                $("#targetLvl").css("border-color","green");
            }
        });

        $("#submitVoucher").click(b =>{



            b.preventDefault();
            b.stopPropagation();



            if($("#currentLvl").val() == 0 || $("#currentLvl").val() == null
                || $("#targetLvl").val() == 0 || $("#targetLvl").val() == null){
              alert("Please fill all required fields")
            }else if(parseInt($("#currentLvl").val()) >= parseInt($("#targetLvl").val())){
               alert("Target Level has to be higher than Current Level");
            }else{
                currentLvl =  parseInt($("#currentLvl").val());
                currentLvlExp = isNaN(parseInt($("#currentLvlExp").val()))?0:parseInt($("#currentLvlExp").val()) ;
                targetLvl  =  parseInt($("#targetLvl").val());
                voucherRun =  isNaN(parseInt($("#voucherPerRun").val()))?0:parseInt($("#voucherPerRun").val()) ;
                isPremium  =  $("#isPremium").prop('checked');
                if(isPremium){
                  voucherExp =  $( "#voucherTypeYesPremium" ).val();
                }else{
                  voucherExp =  $( "#voucherTypeNoPremium" ).val();
                }


                expAim = 0;
                voucherAmmount = 0;


                if(currentLvlExp != null && currentLvlExp > 0){
                  for(i=1; i<=targetLvl; i++){
                      expAim += i*5;
                  }
                  expAim = expAim - currentLvlExp;
                }else {
                  for(i=currentLvl+1; i<=targetLvl; i++){
                      expAim += i*5;
                  }
                }

                voucherAmmount = expAim/voucherExp;


                $("#voucherAmmount").val(Math.ceil(voucherAmmount));
                if(voucherRun!= null && voucherRun >0){
                  $("#runsAmmount").val(Math.ceil(voucherAmmount/voucherRun));
                }else{
                  $("#runsAmmount").val("Not specified or invalid")
                }
                $("#expAmmount").val(Math.ceil(expAim));



            /*    console.log("currentLvl->",currentLvl);
                console.log("targetLvl->",targetLvl);
                console.log("expAim->",expAim);
                  console.log("voucherExp->",voucherExp);
                  console.log("voucherRun->",voucherRun);
                  */
            }



        })

    });

</script>
<style>

    body{
      font-family: arial,sans-serif;
    }

    fieldset{

        float: left;
        width: 300px;
        height: auto;
    }
    input{
        padding: .4em;
        display: block;
        margin-bottom: 10px;
    }
    .singleField{
      margin-bottom: 15px;
    }

    .hiddenS{
      display: none;
    }
    #lastUpdated{
      position: fixed;
      bottom: 0;

    }


</style>
</body>
</html>